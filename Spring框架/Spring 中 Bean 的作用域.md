# Spring 中 Bean 的作用域以及是否安全

## 作用域

Bean 的作用域是 Bean 的创建方式，生命周期，使用范围等。



* signleton（单例），默认的作用域方式，单例模式的创造 Bean，Bean 是唯一的，使用的 Bean 都是同一个 Bean，适用于全局配置，整个应用程序共享的 Bean。
* prototype（原型），每次请求 Bean 的时候，都会创建一个新的 Bean ，适用于每一个使用场景需要不同状态的 Bean。
* request （请求），仅适用于 web 应用程序中，每一次请求都会创建一个新的 Bean ，在请求过程中共享 Bean ,请求结束后会摧毁该 Bean 。
* session (会话)，仅适用于 web 应用程序中，每一次 session 回话中会创建一个新的 Bean，在会话过程中共享该 Bean ，会话结束后会摧毁该 Bean。
* Global session （全局会话），仅适用于 web 应用程序中，在整个 web 应用程序中都会共享该 Bean，在整个应用程序的所有会话中共享。
* WebSocket，仅适用于 web 应用程序中，每一次 WebSocket 中会创建一个新的Bean。



可以使用 xml 文件配置与注解的方式配置 Bean 的作用域。

通常使用注解，注解@Scope 中的属性 value 进行配置。





## Bean 是不是线程安全的

Bean 是否为线程安全，主要取决于它的作用域以及状态（Bean 中有没有可变的成员变量）。



* 单例，默认的作用域方式，如果 Bean 中没有可变的成员变量，那么该 Bean 就是线程安全的。如果有的话就会存在线程不安全的现象。
* 原型，每一次请求都会创建新的 Bean ,既然如此，那么就不会出现线程不安全的现象，因为每一次都是新的 Bean ，相互不打扰。 
* 请求，会话，这些只要有可变的成员变量都会出现线程不安全的现象。



解决方法：

* 尽量避免 Bean 中有可变变量，一定要有的话，可以使用 sychronized 等锁保证代码的同步。
* 如果有可变变量，建议可以使用 TheadLocal,来存储可变变量。







